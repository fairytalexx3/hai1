<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HAPPY BIRTHDAY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <style>
      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
      }
      #fireworks {
        position: fixed;
        top: 0;
        left: 0;
        z-index: 0;
      }
    </style>
  </head>
  <body
    style="
      background-image: url(https://images.unsplash.com/photo-1530273973427-22351773250c?q=80&w=1470&auto=format&fit=crop);
      background-size: cover;
      background-position: center;
    "
    class="flex justify-center h-screen items-center relative"
  >
    <!-- Canvas kembang api -->
    <canvas id="fireworks"></canvas>

    <!-- Kartu ucapan -->
    <div
      class="bg-white border px-10 py-8 border-4 border-gray-300 shadow-lg shadow-blue-300 rounded-xl text-center animate__animated animate__backInDown m-8 w-80 relative z-10"
      id="kartu"
    >
      <h1 class="text-3xl">Happy Birthday</h1>
      <h1
        class="text-4xl text-blue-500 font-bold animate__animated animate__pulse animate__infinite"
      >
        KAMU
      </h1>
      <button
        class="p-2 bg-blue-600 text-white rounded mt-5 hover:bg-blue-900 transition ease-in w-full animate__animated animate__delay-1s animate__tada"
        onclick="ubahKartu()"
      >
        Klik Disini Bro!
      </button>
    </div>

    <!-- Audio dari YouTube (disembunyikan) -->
    <iframe
      id="ytplayer"
      width="0"
      height="0"
      src="https://www.youtube.com/embed/Rht8rS4cR1s?enablejsapi=1&autoplay=0&loop=1&playlist=Rht8rS4cR1s"
      frameborder="0"
      allow="autoplay"
    ></iframe>

    <script src="https://cdn.jsdelivr.net/npm/@tsparticles/confetti@3.0.3/tsparticles.confetti.bundle.min.js"></script>
    <script>
      // confetti sekali di awal
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 },
      });

      let kartu = document.getElementById("kartu");

      // array pesan
      const pesan = [
        "Selamat ulang tahun,  Semoga makin banyak kebahagiaan ğŸ‰",
        "Rezeki lancar dan semua impian jadi kenyataan ğŸ™",
        "Semoga kita terus bareng-bareng, seru-seruan, saling dukung â¤ï¸",
        "Eh ternyata hadiah nya PRANK ğŸ˜œ",
        "Harapanku buat kamu kedepannya:<br><br>selamat ulang tahun kamu!ğŸ‰<br>semoga di usia yang baru ini, kamu selalu diberi kesehatan, kebahagiaan, dan kekuatan untuk meraih setiap mimpi. Ingat, bertambahnya usia bukan sekadar angka, tapi kesempatan baru untuk jadi versi terbaik diri. Sehat-sehat ya kamu â¤ï¸",
        "Sekali lagi selamat ulang tahun, semoga setiap detik di hidupmu selalu dipenuhi kebahagiaan dan berkah yang tak pernah putus.<br><br><div class='mt-6 font-semibold'>- Dari : Seseorang -</div>"
      ];

      let indexPesan = 0;

      function playYoutube() {
        const yt = document.getElementById("ytplayer").contentWindow;
        yt.postMessage('{"event":"command","func":"playVideo","args":""}', "*");
      }

      function ubahKartu() {
        playYoutube();
        tampilkanPesan();
      }

      function tampilkanPesan() {
        const isLast = indexPesan === pesan.length - 1;

        // khusus slide ke-2 (index 2): tampilkan 2 tombol (Selanjutnya & Hadiah)
        if (indexPesan === 2) {
          kartu.innerHTML = `
            <h1 class="font-semibold text-wrap animate__animated animate__zoomIn">
              ${pesan[indexPesan]}
            </h1>
            <div class="grid grid-cols-2 gap-2 mt-5">
              <button
                class="p-2 bg-blue-600 text-white rounded hover:bg-blue-900 transition ease-in animate__animated animate__tada"
                onclick="selanjutnya()"
              >
                Selanjutnya
              </button>
              <button
                class="p-2 bg-pink-600 text-white rounded hover:bg-pink-900 transition ease-in animate__animated animate__tada"
                onclick="hadiah()"
              >
                Hadiah ğŸ
              </button>
            </div>
          `;
        } else {
          kartu.innerHTML = `
            <h1 class="font-semibold text-wrap animate__animated animate__zoomIn">
              ${pesan[indexPesan]}
            </h1>
            ${
              !isLast
                ? `<button
                    class="p-2 bg-blue-600 text-white rounded mt-5 hover:bg-blue-900 transition ease-in w-full animate__animated animate__tada"
                    onclick="selanjutnya()"
                  >
                    Selanjutnya
                  </button>`
                : ""
            }
          `;
        }
      }

      function selanjutnya() {
        if (indexPesan === 2) {
          indexPesan = 4; // skip langsung ke harapan
        } else {
          indexPesan++;
        }
        if (indexPesan >= pesan.length) indexPesan = pesan.length - 1;
        tampilkanPesan();
      }

      function hadiah() {
        indexPesan = 3; // slide prank
        tampilkanPesan();
      }

      // ---------- Kembang Api ----------
      const canvas = document.getElementById("fireworks");
      const ctx = canvas.getContext("2d");

      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resizeCanvas();
      window.addEventListener("resize", resizeCanvas);

      let fireworks = [];
      let particles = [];

      class Firework {
        constructor(x, y, targetY, color) {
          this.x = x;
          this.y = y;
          this.targetY = targetY;
          this.color = color;
          this.speed = 5;
        }
        update() {
          this.y -= this.speed;
          if (this.y <= this.targetY) {
            this.explode();
            return true;
          }
          this.draw();
          return false;
        }
        draw() {
          ctx.beginPath();
          ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
          ctx.fillStyle = this.color;
          ctx.fill();
        }
        explode() {
          for (let i = 0; i < 60; i++) {
            particles.push(new Particle(this.x, this.y, this.color));
          }
        }
      }

      class Particle {
        constructor(x, y, color) {
          this.x = x;
          this.y = y;
          this.color = color;
          this.speed = Math.random() * 5 + 1;
          this.angle = Math.random() * Math.PI * 2;
          this.alpha = 1;
          this.decay = Math.random() * 0.02 + 0.01;
        }
        update() {
          this.x += Math.cos(this.angle) * this.speed;
          this.y += Math.sin(this.angle) * this.speed;
          this.alpha -= this.decay;
          this.draw();
          return this.alpha <= 0;
        }
        draw() {
          ctx.save();
          ctx.globalAlpha = this.alpha;
          ctx.beginPath();
          ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
          ctx.fillStyle = this.color;
          ctx.fill();
          ctx.restore();
        }
      }

      function animate() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (Math.random() < 0.04) {
          let x = Math.random() * canvas.width;
          let color = `hsl(${Math.random() * 360},100%,50%)`;
          fireworks.push(
            new Firework(x, canvas.height, Math.random() * canvas.height / 2, color)
          );
        }

        for (let i = fireworks.length - 1; i >= 0; i--) {
          if (fireworks[i].update()) fireworks.splice(i, 1);
        }

        for (let i = particles.length - 1; i >= 0; i--) {
          if (particles[i].update()) particles.splice(i, 1);
        }

        requestAnimationFrame(animate);
      }
      animate();

      canvas.addEventListener("click", (e) => {
        let x = e.clientX;
        let color = `hsl(${Math.random() * 360},100%,50%)`;
        fireworks.push(new Firework(x, canvas.height, e.clientY, color));
      });
    </script>
  </body>
</html>
